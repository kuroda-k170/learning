// 職業タイプを変換するマッピング
var jobTypeMap = {
    '10': '医師',
    '20': '看護師',
    '30': '薬剤師'
};

// プルダウンをクリア
pulldown.empty();

// 「すべて」のオプションを追加
pulldown.append('<option value="0">すべて</option>');

// ユーザー情報を職業タイプでグループ化
var usersByJobType = {};

// usersを走査してグループ化
$.each(users, function(index, item) {
    var jobTypeKey = item.job_type.toString(); // job_typeを文字列に変換
    var jobTypeName = jobTypeMap[jobTypeKey] || '事務'; // マッピングされていない場合は「事務」

    if (!usersByJobType[jobTypeName]) {
        usersByJobType[jobTypeName] = [];
    }
    usersByJobType[jobTypeName].push(item);
});

// グループごとにプルダウンに追加
$.each(usersByJobType, function(jobTypeName, usersInGroup) {
    // ユーザーが存在する場合のみグループを作成
    if (usersInGroup.length > 0) {
        var optgroup = $('<optgroup>', { label: jobTypeName });

        // グループ内のユーザーをオプションとして追加
        $.each(usersInGroup, function(index, user) {
            optgroup.append($('<option>', { value: user.id, text: user.name }));
        });

        // プルダウンに`<optgroup>`を追加
        pulldown.append(optgroup);
    }
});